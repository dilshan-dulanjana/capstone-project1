"use strict";var e=require("react"),t=require("../../context/PresenceContext.cjs"),n=require("../../context/MotionContext/index.cjs"),o=require("../../utils/use-isomorphic-effect.cjs"),i=require("../../context/LazyContext.cjs"),r=require("../../context/MotionConfigContext.cjs");exports.useVisualElement=function(a,s,u,c){const{visualElement:x}=e.useContext(n.MotionContext),f=e.useContext(i.LazyContext),C=e.useContext(t.PresenceContext),d=e.useContext(r.MotionConfigContext).reducedMotion,m=e.useRef();c=c||f.renderer,!m.current&&c&&(m.current=c(a,{visualState:s,parent:x,props:u,presenceContext:C,blockInitialAnimation:!!C&&!1===C.initial,reducedMotionConfig:d}));const p=m.current;e.useInsertionEffect((()=>{p&&p.update(u,C)}));const l=e.useRef(Boolean(window.HandoffAppearAnimations));return o.useIsomorphicLayoutEffect((()=>{p&&(p.render(),l.current&&p.animationState&&p.animationState.animateChanges())})),e.useEffect((()=>{p&&(p.updateFeatures(),!l.current&&p.animationState&&p.animationState.animateChanges(),window.HandoffAppearAnimations=void 0,l.current=!1)})),p};
